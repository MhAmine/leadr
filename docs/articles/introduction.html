<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction • leadr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">leadr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/introduction.html">Introduction</a>
</li>
<li>
  <a href="../articles/ensemble.html">Ensembles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/tmastny/leadr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction</h1>
                        <h4 class="author">Tim Mastny</h4>
            
            <h4 class="date">2018-03-07</h4>
          </div>

    
    
<div class="contents">
<p>This vignette will show the basic <code>leadr</code> workflow. To see how <code>leadr</code> supports more advanced ensemble model building, check out my other vignette.</p>
<p><code>leadr</code> is intended to be used within an R project for one dataset. Currently, the leaderboard works best placed at the project root, with any number of subdirectories to save the models.</p>
<div id="getting-started" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting Started</h2>
<p>I usually start with these packages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(purrr)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(caret)
<span class="kw">library</span>(leadr)</code></pre></div>
<p>Let’s build some models. We can easily build a list of models using <code><a href="http://www.rdocumentation.org/packages/purrr/topics/map">purrr::map</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(
  <span class="kw">rep</span>(<span class="st">"rf"</span>, <span class="dv">4</span>),
  <span class="op">~</span><span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/train">train</a></span>(
    Species <span class="op">~</span><span class="st"> </span>.,
    <span class="dt">data =</span> iris
  )
)</code></pre></div>
<p>We can also <code>purrr</code> the models into our leaderboard. This time we use <code><a href="http://www.rdocumentation.org/packages/purrr/topics/map">purrr::walk</a></code> since want to update the leaderboard, but don’t care about the return value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">walk</a></span>(models, board)
<span class="kw"><a href="../reference/board.html">board</a></span>()
<span class="co">#&gt; # A tibble: 4 x 13</span>
<span class="co">#&gt;    rank    id dir     model metric  score public method   num group index </span>
<span class="co">#&gt;   &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt; 1    1.     2 models… rf    Accura… 0.955     NA boot     25.    2. &lt;list…</span>
<span class="co">#&gt; 2    2.     4 models… rf    Accura… 0.950     NA boot     25.    4. &lt;list…</span>
<span class="co">#&gt; 3    3.     3 models… rf    Accura… 0.946     NA boot     25.    3. &lt;list…</span>
<span class="co">#&gt; 4    4.     1 models… rf    Accura… 0.942     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; # ... with 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p>By default, <code>board</code> saves the models into a folder at the root of the project called <code>models_one</code> and returns a tibble that provides us with everything we want to know about the model.</p>
<p>The tibble gives us the ranking and metric score, as well as lists like <code>tune</code>, <code>index</code>, and <code>seed</code> that allow us to exactly recreate the model.</p>
</div>
<div id="groups" class="section level2">
<h2 class="hasAnchor">
<a href="#groups" class="anchor"></a>Groups</h2>
<p>Of course, fitting four random forest models isn’t very realistic. The idea is that we can fit many different types of models. Let’s try a different type of model, using the same index as the first model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">first_id &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw"><a href="../reference/board.html">board</a></span>()<span class="op">$</span>id <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
control &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/trainControl">trainControl</a></span>(<span class="dt">index =</span> <span class="kw"><a href="../reference/board.html">board</a></span>()<span class="op">$</span>index[[first_id]])
model &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/train">train</a></span>(Species <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> iris, <span class="dt">method =</span> <span class="st">'glmnet'</span>, <span class="dt">trControl =</span> control)
<span class="kw"><a href="../reference/board.html">board</a></span>(model)
<span class="co">#&gt; # A tibble: 5 x 13</span>
<span class="co">#&gt;    rank    id dir     model  metric score public method   num group index </span>
<span class="co">#&gt;   &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt; 1    1.     2 models… rf     Accur… 0.955     NA boot     25.    2. &lt;list…</span>
<span class="co">#&gt; 2    2.     5 models… glmnet Accur… 0.952     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; 3    3.     4 models… rf     Accur… 0.950     NA boot     25.    4. &lt;list…</span>
<span class="co">#&gt; 4    4.     3 models… rf     Accur… 0.946     NA boot     25.    3. &lt;list…</span>
<span class="co">#&gt; 5    5.     1 models… rf     Accur… 0.942     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; # ... with 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p>Fitting the model on the same bootstrap or cross-validation index allows us to compare models using some caret functions. The <code>group</code> column indicates which models are fit on the same index, and we’ll use <code><a href="../reference/to_list.html">leadr::to_list()</a></code> to covert the filtered leaderboard to a list of models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">group &lt;-<span class="st"> </span><span class="kw"><a href="../reference/board.html">board</a></span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(group <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/to_list.html">to_list</a></span>()</code></pre></div>
<p>From there, we can compare models using the <code>resamples</code> family of caret functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/resamples">resamples</a></span>(group)
<span class="kw">summary</span>(results)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; summary.resamples(object = results)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Models: Model1, Model2 </span>
<span class="co">#&gt; Number of resamples: 25 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Accuracy </span>
<span class="co">#&gt;             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's</span>
<span class="co">#&gt; Model1 0.9107143 0.9433962 0.9473684 0.9516469 0.9655172 1.0000000    0</span>
<span class="co">#&gt; Model2 0.8928571 0.9298246 0.9433962 0.9416994 0.9629630 0.9814815    0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Kappa </span>
<span class="co">#&gt;             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's</span>
<span class="co">#&gt; Model1 0.8638794 0.9152452 0.9197047 0.9266939 0.9478886 1.0000000    0</span>
<span class="co">#&gt; Model2 0.8365759 0.8944444 0.9152452 0.9116796 0.9444444 0.9720352    0</span>

<span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/resamples">modelCor</a></span>(results)
<span class="co">#&gt;           Model1    Model2</span>
<span class="co">#&gt; Model1 1.0000000 0.6676862</span>
<span class="co">#&gt; Model2 0.6676862 1.0000000</span>
<span class="kw">splom</span>(results)</code></pre></div>
<p><img src="introduction_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="peaking" class="section level2">
<h2 class="hasAnchor">
<a href="#peaking" class="anchor"></a>Peaking</h2>
<p><code>leadr</code> also has tools to help you find ranking of models as the leaderboard gets big. Let’s add a few more models:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">map</a></span>(
  <span class="kw">rep</span>(<span class="st">"rf"</span>, <span class="dv">20</span>),
  <span class="op">~</span><span class="kw"><a href="http://www.rdocumentation.org/packages/caret/topics/train">train</a></span>(
    Species <span class="op">~</span><span class="st"> </span>.,
    <span class="dt">data =</span> iris
  )
)

<span class="kw"><a href="http://www.rdocumentation.org/packages/purrr/topics/map">walk</a></span>(models, board)
<span class="kw"><a href="../reference/board.html">board</a></span>()
<span class="co">#&gt; # A tibble: 25 x 13</span>
<span class="co">#&gt;     rank    id dir     model metric score public method   num group index </span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt;  1    1.    25 models… rf    Accur… 0.959     NA boot     25.   24. &lt;list…</span>
<span class="co">#&gt;  2    2.    21 models… rf    Accur… 0.959     NA boot     25.   20. &lt;list…</span>
<span class="co">#&gt;  3    3.     6 models… rf    Accur… 0.956     NA boot     25.    5. &lt;list…</span>
<span class="co">#&gt;  4    4.    16 models… rf    Accur… 0.955     NA boot     25.   15. &lt;list…</span>
<span class="co">#&gt;  5    5.     2 models… rf    Accur… 0.955     NA boot     25.    2. &lt;list…</span>
<span class="co">#&gt;  6    6.     9 models… rf    Accur… 0.953     NA boot     25.    8. &lt;list…</span>
<span class="co">#&gt;  7    7.     7 models… rf    Accur… 0.953     NA boot     25.    6. &lt;list…</span>
<span class="co">#&gt;  8    8.    20 models… rf    Accur… 0.953     NA boot     25.   19. &lt;list…</span>
<span class="co">#&gt;  9    9.    17 models… rf    Accur… 0.952     NA boot     25.   16. &lt;list…</span>
<span class="co">#&gt; 10   10.     5 models… glmn… Accur… 0.952     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; # ... with 15 more rows, and 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p>We can no longer see every model on the leaderboard. That’s where <code><a href="../reference/peak.html">leadr::peak</a></code> helps out. Let’s look at the ranking of the first model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/board.html">board</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/peak.html">peak</a></span>(<span class="dv">1</span>)
<span class="co">#&gt; # A tibble: 10 x 13</span>
<span class="co">#&gt;     rank    id dir     model metric score public method   num group index </span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt;  1   16.    24 models… rf    Accur… 0.950     NA boot     25.   23. &lt;list…</span>
<span class="co">#&gt;  2   17.    19 models… rf    Accur… 0.949     NA boot     25.   18. &lt;list…</span>
<span class="co">#&gt;  3   18.     8 models… rf    Accur… 0.949     NA boot     25.    7. &lt;list…</span>
<span class="co">#&gt;  4   19.    11 models… rf    Accur… 0.946     NA boot     25.   10. &lt;list…</span>
<span class="co">#&gt;  5   20.     3 models… rf    Accur… 0.946     NA boot     25.    3. &lt;list…</span>
<span class="co">#&gt;  6   21.    10 models… rf    Accur… 0.945     NA boot     25.    9. &lt;list…</span>
<span class="co">#&gt;  7   22.    12 models… rf    Accur… 0.944     NA boot     25.   11. &lt;list…</span>
<span class="co">#&gt;  8   23.     1 models… rf    Accur… 0.942     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt;  9   24.    13 models… rf    Accur… 0.939     NA boot     25.   12. &lt;list…</span>
<span class="co">#&gt; 10   25.    18 models… rf    Accur… 0.938     NA boot     25.   17. &lt;list…</span>
<span class="co">#&gt; # ... with 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p>Often, we want to see how the model we just ran ranks:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/board.html">board</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/peak.html">peak</a></span>(<span class="kw"><a href="../reference/at_last.html">at_last</a></span>())
<span class="co">#&gt; # A tibble: 10 x 13</span>
<span class="co">#&gt;     rank    id dir     model metric score public method   num group index </span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt;  1    1.    25 models… rf    Accur… 0.959     NA boot     25.   24. &lt;list…</span>
<span class="co">#&gt;  2    2.    21 models… rf    Accur… 0.959     NA boot     25.   20. &lt;list…</span>
<span class="co">#&gt;  3    3.     6 models… rf    Accur… 0.956     NA boot     25.    5. &lt;list…</span>
<span class="co">#&gt;  4    4.    16 models… rf    Accur… 0.955     NA boot     25.   15. &lt;list…</span>
<span class="co">#&gt;  5    5.     2 models… rf    Accur… 0.955     NA boot     25.    2. &lt;list…</span>
<span class="co">#&gt;  6    6.     9 models… rf    Accur… 0.953     NA boot     25.    8. &lt;list…</span>
<span class="co">#&gt;  7    7.     7 models… rf    Accur… 0.953     NA boot     25.    6. &lt;list…</span>
<span class="co">#&gt;  8    8.    20 models… rf    Accur… 0.953     NA boot     25.   19. &lt;list…</span>
<span class="co">#&gt;  9    9.    17 models… rf    Accur… 0.952     NA boot     25.   16. &lt;list…</span>
<span class="co">#&gt; 10   10.     5 models… glmn… Accur… 0.952     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; # ... with 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p><code><a href="../reference/peak.html">leadr::peak</a></code> also takes a variable number of inputs. If we want to compare the last to the first model, it will return the smallest tibble that contains both. If it is under 20 rows, it will print the entire tibble.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/board.html">board</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="../reference/peak.html">peak</a></span>(<span class="kw"><a href="../reference/at_last.html">at_last</a></span>(), <span class="dv">1</span>)
<span class="co">#&gt; # A tibble: 23 x 13</span>
<span class="co">#&gt;     rank    id dir     model metric score public method   num group index </span>
<span class="co">#&gt;    &lt;dbl&gt;  &lt;id&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;list&gt;</span>
<span class="co">#&gt;  1    1.    25 models… rf    Accur… 0.959     NA boot     25.   24. &lt;list…</span>
<span class="co">#&gt;  2    2.    21 models… rf    Accur… 0.959     NA boot     25.   20. &lt;list…</span>
<span class="co">#&gt;  3    3.     6 models… rf    Accur… 0.956     NA boot     25.    5. &lt;list…</span>
<span class="co">#&gt;  4    4.    16 models… rf    Accur… 0.955     NA boot     25.   15. &lt;list…</span>
<span class="co">#&gt;  5    5.     2 models… rf    Accur… 0.955     NA boot     25.    2. &lt;list…</span>
<span class="co">#&gt;  6    6.     9 models… rf    Accur… 0.953     NA boot     25.    8. &lt;list…</span>
<span class="co">#&gt;  7    7.     7 models… rf    Accur… 0.953     NA boot     25.    6. &lt;list…</span>
<span class="co">#&gt;  8    8.    20 models… rf    Accur… 0.953     NA boot     25.   19. &lt;list…</span>
<span class="co">#&gt;  9    9.    17 models… rf    Accur… 0.952     NA boot     25.   16. &lt;list…</span>
<span class="co">#&gt; 10   10.     5 models… glmn… Accur… 0.952     NA boot     25.    1. &lt;list…</span>
<span class="co">#&gt; # ... with 13 more rows, and 2 more variables: tune &lt;list&gt;, seeds &lt;list&gt;</span></code></pre></div>
<p>Thanks to <a href="https://github.com/r-lib/pillar">pillar</a> and <a href="https://github.com/r-lib/crayon">crayon</a>, <code><a href="../reference/peak.html">leadr::peak</a></code> also has special printing capabilities when used in a supported console. Here is an example of <code>peak</code> in the RStudio console. Notice that it highlights the peaked models in the output.</p>
<p><img src="leadr_pic.png" width="676" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#getting-started">Getting Started</a></li>
      <li><a href="#groups">Groups</a></li>
      <li><a href="#peaking">Peaking</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Tim Mastny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
